# OceanBase Connector/J V2.4.5

## 版本信息

- 发布时间：2023 年 08 月 18 日 
- 版本号：V2.4.5

## 版本定位

推出 OceanBase Connector/J V2.4.5 版本，支持返回 `AutoGeneratedKey` 的 `PreparedStatement`，支持 server 感知客户端版本号。

## 功能增强

- 支持 server 感知 proxy 和 client 版本号。
- 支持返回 `AutoGeneratedKey` 的 `PreparedStatement`。
  <main id="notice" type='explain'>
    <h4>说明</h4>
    <p>如需使用 <code>PreparedStatement</code> 对象返回 <code>AutoGeneratedKey</code>，OceanBase Connector/J 版本须大于等于 2.4.5，须在连接串中加上 <code>useOraclePrepareExecute=true</code>。</p>
  </main>
- URL 参数变更：

| Option 名称 | 状态 | 默认值 | 描述 | 备注 |
| --- | --- | --- | --- | --- |
| compatibleOjdbcVersion  | 新增 | 6     | 设置兼容目标 ojdbc 的版本，可设置为 6、8。设置为其它整数时不会报错，会按照默认值处理。 |  |
| useInformationSchema    | 新增 | false | 是否应该使用 INFORMATION_SCHEMA 来派生 “DatabaseMetaData” 使用的信息。 |  |
| compatibleMysqlVersion	| 新增 | 5     | 设置兼容目标 mysql-jdbc 的版本，可设置为 5、8。设置为其它整数时不会报错，按照默认值处理。|  |
| useOraclePrepareExecute | 优化 | false | 开启 PS 二合一协议，Oracle 模式 `preparedStatement` 在使用 `COM_STMT_PREPARE_EXECUTE` 执行之前不会与 server 通信。 | 当前版本 `useOraclePrepareExecute` 为 `true` 时，`useServerPrepStmts` 被设为 `true`。V2.4.5 之前版本需要共同使用，才能开启 PS 二合一协议。 |

## 缺陷修复

- 修复 `getSchema` 接口 Oracle 兼容处理引发的问题。
- 修复开启 ssl+2.0 协议，JDBC 连接 proxy 建连报错的问题。
- 修复 OBClient 驱动 bug 开启 PS 前，报错 ：out of range for column 的问题。
- 修复参数 `jdbcCompliantTruncation=true`，`getInt/getLong` 接口获取超长数据不抛异常的问题。
- 修复 server 改动，OceanBase Connector/J PS 协议下 `datetime` 类型 0 值，getXXX 接口返回 null 的问题。
- 修复 getString 获取 `datetime` 0 值与 mysql-jdbc 8 不兼容的问题。